# CST Tools Implementation Status

**Author**: Vasiliy Zdanovskiy  
**Email**: vasilyvz@gmail.com  
**Date**: 2025-01-12  
**Purpose**: –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ CST –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —á—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å

---

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (—á—Ç–æ –£–ñ–ï –ï–°–¢–¨)

### ‚úÖ –ö–æ–º–∞–Ω–¥—ã (–≤—Å–µ —Ä–∞–±–æ—Ç–∞—é—Ç –∏ –∏–º–µ—é—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ)

1. **`list_cst_blocks`** (`code_analysis/commands/list_cst_blocks_command.py`)
   - ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
   - ‚úÖ –ò–º–µ–µ—Ç –ø–æ–ª–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
   - ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –±–ª–æ–∫–∏ (functions/classes/methods) —Å stable IDs
   - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è block_id –¥–ª—è compose_cst_module

2. **`query_cst`** (`code_analysis/commands/query_cst_command.py`)
   - ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
   - ‚úÖ –ò–º–µ–µ—Ç –ø–æ–ª–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
   - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç CSTQuery –¥–ª—è –ø–æ–∏—Å–∫–∞ —É–∑–ª–æ–≤
   - ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç node_id –¥–ª—è compose_cst_module
   - ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç XPath-–ø–æ–¥–æ–±–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å

3. **`compose_cst_module`** (`code_analysis/commands/cst_compose_module_command.py`)
   - ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
   - ‚úÖ –ò–º–µ–µ—Ç –ø–æ–ª–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (—Ç–æ–ª—å–∫–æ —á—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω—ã)
   - ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏: replace, insert, create
   - ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å —Å–µ–ª–µ–∫—Ç–æ—Ä–∞–º–∏: block_id, node_id, cst_query, function, class, method, range
   - ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è (compile, docstrings, linter, type checker)
   - ‚úÖ –ê—Ç–æ–º–∞—Ä–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å backup –∏ git commit
   - ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ë–î
   - ‚úÖ Preview mode (apply=false)

### ‚úÖ –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (`code_analysis/core/cst_module/`)

1. **–ú–æ–¥–µ–ª–∏** (`models.py`)
   - ‚úÖ `Selector` - —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ —É–∑–ª–æ–≤
   - ‚úÖ `ReplaceOp` - –æ–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞–º–µ–Ω—ã
   - ‚úÖ `InsertOp` - –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—Å—Ç–∞–≤–∫–∏
   - ‚úÖ `CreateOp` - –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è
   - ‚úÖ `BlockInfo` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–ª–æ–∫–∞—Ö

2. **–£—Ç–∏–ª–∏—Ç—ã**
   - ‚úÖ `blocks.py` - `list_cst_blocks()` - —Å–ø–∏—Å–æ–∫ –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –±–ª–æ–∫–æ–≤
   - ‚úÖ `patcher.py` - `apply_replace_ops()` - –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π –∑–∞–º–µ–Ω—ã
   - ‚úÖ `patcher_insert.py` - `apply_insert_ops()` - –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π –≤—Å—Ç–∞–≤–∫–∏
   - ‚úÖ `patcher_create.py` - `apply_create_ops()` - –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π —Å–æ–∑–¥–∞–Ω–∏—è
   - ‚úÖ `validation.py` - –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤
   - ‚úÖ `utils.py` - —É—Ç–∏–ª–∏—Ç—ã (compile_module, unified_diff, etc.)

3. **CSTQuery** (`code_analysis/cst_query/`)
   - ‚úÖ –ü–∞—Ä—Å–µ—Ä –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏ (Lark)
   - ‚úÖ Executor –¥–ª—è –ø–æ–∏—Å–∫–∞ —É–∑–ª–æ–≤
   - ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ XPath-–ø–æ–¥–æ–±–Ω–æ–≥–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞

### ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `cst_trees` - —Ö—Ä–∞–Ω–µ–Ω–∏–µ CST –∫–æ–¥–∞ (source code, –Ω–µ –¥–µ—Ä–µ–≤–æ)
- ‚úÖ –ú–µ—Ç–æ–¥—ã: `save_cst_tree()`, `get_cst_tree()`, `overwrite_cst_tree()`

---

## ‚ùå –ß—Ç–æ –û–¢–°–£–¢–°–¢–í–£–ï–¢ (—Å–æ–≥–ª–∞—Å–Ω–æ –ø–ª–∞–Ω—É —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞)

### ‚ùå –ù–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (`code_analysis/core/cst_tree/`)

**–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ù–ï —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!**

–ù—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å:
1. **`__init__.py`** - —ç–∫—Å–ø–æ—Ä—Ç—ã –º–æ–¥—É–ª—è
2. **`models.py`** - –Ω–æ–≤—ã–µ –º–æ–¥–µ–ª–∏:
   - ‚ùå `CSTTree` - –∫–ª–∞—Å—Å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–µ—Ä–µ–≤–∞ —Å tree_id (–ø–æ–ª–Ω–æ–µ CST –¥–µ—Ä–µ–≤–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
   - ‚ùå `TreeNodeMetadata` - –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —É–∑–ª–∞ —Å ID –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ (–¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∫–ª–∏–µ–Ω—Ç—É)
   - ‚ùå `TreeOperation` - –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ (replace, insert, remove)
3. **`tree_builder.py`** - –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ –≤ –¥–µ—Ä–µ–≤–æ:
   - ‚ùå `load_file_to_tree(file_path) -> CSTTree`
   - ‚ùå –ì–µ–Ω–µ—Ä–∞—Ü–∏—è node_id –¥–ª—è –≤—Å–µ—Ö —É–∑–ª–æ–≤
   - ‚ùå –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ in-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
4. **`tree_modifier.py`** - –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–µ—Ä–µ–≤–∞:
   - ‚ùå `modify_tree(tree_id, operations) -> CSTTree`
   - ‚ùå –ê—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π (–≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º)
   - ‚ùå Rollback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
5. **`tree_saver.py`** - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–∞:
   - ‚ùå `save_tree_to_file(tree_id, file_path, **options) -> str`
   - ‚ùå –ê—Ç–æ–º–∞—Ä–Ω–∞—è –∑–∞–ø–∏—Å—å —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π, backup, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ –ë–î, git commit
6. **`tree_finder.py`** - –ø–æ–∏—Å–∫ —É–∑–ª–æ–≤:
   - ‚ùå `find_nodes(tree_id, query, search_type) -> list[TreeNodeMetadata]`
   - ‚ùå –ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫ (–ø–æ —Ç–∏–ø—É, –∏–º–µ–Ω–∏, –ø–æ–∑–∏—Ü–∏–∏)
   - ‚ùå XPath-–ø–æ–¥–æ–±–Ω—ã–π –ø–æ–∏—Å–∫ (–∞–¥–∞–ø—Ç–∞—Ü–∏—è CSTQuery –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–µ—Ä–µ–≤–æ–º)
7. **`tree_metadata.py`** - –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —É–∑–ª–æ–≤:
   - ‚ùå `get_node_metadata(tree_id, node_id, **options) -> TreeNodeMetadata`
   - ‚ùå `get_node_children(tree_id, node_id, **options) -> list[TreeNodeMetadata]`
   - ‚ùå `get_node_parent(tree_id, node_id) -> TreeNodeMetadata | None`

### ‚ùå In-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

- ‚ùå –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–µ—Ä–µ–≤—å–µ–≤ —Å tree_id (dict —Å UUID –∫–ª—é—á–∞–º–∏)
- ‚ùå –ü–æ–ª–Ω–æ–µ CST –¥–µ—Ä–µ–≤–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- ‚ùå –ö–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —É–∑–ª–æ–≤

### ‚ùå –ù–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã

1. **`cst_load_file`** - –ù–ï —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
   - –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ –≤ CST –¥–µ—Ä–µ–≤–æ
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (in-memory)
   - –í–æ–∑–≤—Ä–∞—Ç tree_id –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —É–∑–ª–æ–≤

2. **`cst_modify_tree`** - –ù–ï —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
   - –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–µ—Ä–µ–≤–∞ –ø–æ node_id
   - Batch operations —Å –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å—é

3. **`cst_save_tree`** - –ù–ï —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–∞ –≤ —Ñ–∞–π–ª
   - –ê—Ç–æ–º–∞—Ä–Ω–∞—è –∑–∞–ø–∏—Å—å —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π

4. **`cst_find_node`** - –ù–ï —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
   - –ü–æ–∏—Å–∫ —É–∑–ª–æ–≤ –ø–æ –¥–µ—Ä–µ–≤—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (tree_id)
   - –ü—Ä–æ—Å—Ç–æ–π –∏ XPath-–ø–æ–¥–æ–±–Ω—ã–π –ø–æ–∏—Å–∫

5. **`cst_get_node_info`** - –ù–ï —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —É–∑–ª–µ (–¥–µ—Ç–∏, —Ä–æ–¥–∏—Ç–µ–ª—å, —Å–æ—Å–µ–¥–∏)

---

## üîç –ö–ª—é—á–µ–≤—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –ø–æ–¥—Ö–æ–¥–æ–≤

### –¢–µ–∫—É—â–∏–π –ø–æ–¥—Ö–æ–¥ (—á—Ç–æ –ï–°–¢–¨)

**Workflow:**
1. `list_cst_blocks` ‚Üí –ø–æ–ª—É—á–∏—Ç—å block_id
2. `query_cst` ‚Üí –ø–æ–ª—É—á–∏—Ç—å node_id (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
3. `compose_cst_module` ‚Üí –ø—Ä–∏–º–µ–Ω–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º –Ω–∞–ø—Ä—è–º—É—é
- ‚úÖ –ö–∞–∂–¥—ã–π —Ä–∞–∑ –ø–∞—Ä—Å–∏—Ç —Ñ–∞–π–ª –∑–∞–Ω–æ–≤–æ
- ‚úÖ –û–ø–µ—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –∫–æ–¥—É
- ‚úÖ –ù–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–π API

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ù—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –∫–∞–∂–¥—ã–π —Ä–∞–∑
- –ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –¥–µ—Ä–µ–≤–æ–º –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
- –ù–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–π –ø–æ–¥—Ö–æ–¥ (—á—Ç–æ –ù–£–ñ–ù–û –î–û–ë–ê–í–ò–¢–¨)

**Workflow:**
1. `cst_load_file` ‚Üí –ø–æ–ª—É—á–∏—Ç—å tree_id –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —É–∑–ª–æ–≤
2. `cst_find_node` ‚Üí –Ω–∞–π—Ç–∏ –Ω—É–∂–Ω—ã–µ —É–∑–ª—ã –ø–æ tree_id
3. `cst_modify_tree` ‚Üí –ø—Ä–∏–º–µ–Ω–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ –∫ –¥–µ—Ä–µ–≤—É (tree_id)
4. `cst_save_tree` ‚Üí —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–µ—Ä–µ–≤–æ –≤ —Ñ–∞–π–ª

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ –î–µ—Ä–µ–≤–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (in-memory)
- ‚úÖ –†–∞–±–æ—Ç–∞ —Å –¥–µ—Ä–µ–≤–æ–º –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –ö–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–º–µ–Ω—å—à–µ —Ç—Ä–∞—Ñ–∏–∫–∞)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ú–µ–Ω—å—à–µ —Ç—Ä–∞—Ñ–∏–∫–∞ (—Ç–æ–ª—å–∫–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ)
- –ë—ã—Å—Ç—Ä–µ–µ –ø–æ–∏—Å–∫ (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –ø–æ –ø–æ–ª–Ω–æ–º—É –¥–µ—Ä–µ–≤—É)
- –ú–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å (–±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞)

---

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

### Phase 1: Core Infrastructure (–ö–†–ò–¢–ò–ß–ù–û)

1. **–°–æ–∑–¥–∞—Ç—å `code_analysis/core/cst_tree/`**
   - [ ] `__init__.py`
   - [ ] `models.py` - CSTTree, TreeNodeMetadata, TreeOperation
   - [ ] In-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (dict —Å tree_id)

2. **–°–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª–∏—Ç—ã**
   - [ ] `tree_builder.py` - –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ –≤ –¥–µ—Ä–µ–≤–æ
   - [ ] `tree_modifier.py` - –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–µ—Ä–µ–≤–∞
   - [ ] `tree_saver.py` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–∞
   - [ ] `tree_finder.py` - –ø–æ–∏—Å–∫ —É–∑–ª–æ–≤ (XPath-–ø–æ–¥–æ–±–Ω—ã–π)
   - [ ] `tree_metadata.py` - –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —É–∑–ª–æ–≤

### Phase 2: New Commands (–í–ê–ñ–ù–û)

1. **–ö–æ–º–∞–Ω–¥—ã**
   - [ ] `cst_load_file_command.py`
   - [ ] `cst_modify_tree_command.py`
   - [ ] `cst_save_tree_command.py`
   - [ ] `cst_find_node_command.py`
   - [ ] `cst_get_node_info_command.py` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

2. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è**
   - [ ] –û–±–Ω–æ–≤–∏—Ç—å `code_analysis/hooks.py`

### Phase 3: Migration (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û)

- [ ] –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã (–µ—Å–ª–∏ –Ω–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–µ–Ω—è–µ—Ç)
- [ ] –ò–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –æ–±–∞ –ø–æ–¥—Ö–æ–¥–∞ –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –í–∞—Ä–∏–∞–Ω—Ç 1: –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥, –æ—Å—Ç–∞–≤–∏—Ç—å —Å—Ç–∞—Ä—ã–π

**–ü–ª—é—Å—ã:**
- –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±–∞ –ø–æ–¥—Ö–æ–¥–∞
- –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

**–ú–∏–Ω—É—Å—ã:**
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- –ë–æ–ª—å—à–µ –∫–æ–¥–∞ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ (—Å–æ–≥–ª–∞—Å–Ω–æ –ø–ª–∞–Ω—É)

**–ü–ª—é—Å—ã:**
- –û–¥–∏–Ω –ø–æ–¥—Ö–æ–¥, –ø—Ä–æ—â–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π workflow
- –ú–µ–Ω—å—à–µ –∫–æ–¥–∞

**–ú–∏–Ω—É—Å—ã:**
- –ù—É–∂–Ω–æ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥
- –ù–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ–¥—Ö–æ–¥

**–ü–ª—é—Å—ã:**
- –í—Å–µ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ù–µ –Ω—É–∂–Ω–æ –Ω–∏—á–µ–≥–æ –¥–æ–±–∞–≤–ª—è—Ç—å
- –ü—Ä–æ—Å—Ç–æ–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–π

**–ú–∏–Ω—É—Å—ã:**
- –ù–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
- –ë–æ–ª—å—à–µ —Ç—Ä–∞—Ñ–∏–∫–∞ (–ø–µ—Ä–µ–¥–∞—á–∞ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞)

---

## ‚úÖ –í—ã–≤–æ–¥

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ –í—Å–µ –±–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å CST –µ—Å—Ç—å
- ‚úÖ –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥ –ø–æ–ª–Ω—ã–µ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω—ã

**–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**
- ‚ùå –ù–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `cst_tree/` (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω –Ω–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥)
- ‚ùå –ù–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω –Ω–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥)
- ‚ùå In-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω –Ω–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥)

**–†–µ—à–µ–Ω–∏–µ:**
–ù—É–∂–Ω–æ —Ä–µ—à–∏—Ç—å, –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ª–∏ –Ω—É–∂–µ–Ω –Ω–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ —Å tree_id –∏ in-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º, –∏–ª–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ–¥—Ö–æ–¥ —Å `compose_cst_module` –¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω –¥–ª—è –∑–∞–¥–∞—á –ø—Ä–æ–µ–∫—Ç–∞.
