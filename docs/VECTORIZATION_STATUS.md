# –°—Ç–∞—Ç—É—Å –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

**Author**: Vasiliy Zdanovskiy  
**Email**: vasilyvz@gmail.com  
**Date**: 2025-12-30

## –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

### ‚úÖ –í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–∞–Ω–∫–æ–≤: 100% –∑–∞–≤–µ—Ä—à–µ–Ω–∞

- **–í—Å–µ–≥–æ —á–∞–Ω–∫–æ–≤**: 9,927
- **–í–µ–∫—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–æ**: 9,927 (100%)
- **–ù–µ –≤–µ–∫—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–æ**: 0
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –≤–µ–∫—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–æ

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

- **–í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤**: 2,262
- **–ê–∫—Ç–∏–≤–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤**: 2,260
- **–§–∞–π–ª–æ–≤ —Å –¥–æ–∫—Å—Ç—Ä–∏–Ω–≥–∞–º–∏**: 2,248
- **–§–∞–π–ª–æ–≤, —Ç—Ä–µ–±—É—é—â–∏—Ö —á–∞–Ω–∫–∏–Ω–≥–∞**: 680
- **–†–∞–∑–º–µ—Ä –ë–î**: 324.4 MB

### üîÑ –í–æ—Ä–∫–µ—Ä –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

- **–°—Ç–∞—Ç—É—Å**: –ù–µ –∑–∞–ø—É—â–µ–Ω (0 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤)
- **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –í–æ—Ä–∫–µ—Ä –Ω–µ –Ω—É–∂–µ–Ω, —Ç–∞–∫ –∫–∞–∫ –≤—Å–µ —á–∞–Ω–∫–∏ —É–∂–µ –≤–µ–∫—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **SVOClientManager** (`code_analysis/core/svo_client_manager.py`)
   - ‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π `EmbeddingServiceAsyncClient` –∏–∑ `embed_client`
   - ‚úÖ **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: –ß–∏—Ç–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ `code_analysis.embedding`:
     - URL –∏ –ø–æ—Ä—Ç —Å–µ—Ä–≤–∏—Å–∞
     - –ü—Ä–æ—Ç–æ–∫–æ–ª (http/https/mtls)
     - –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è mTLS (cert_file, key_file, ca_cert_file, crl_file)
     - –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–æ–≤
   - ‚úÖ **Fallback**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Å–µ–≤–¥–æ-—ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞

2. **VectorizationWorker** (`code_analysis/core/vectorization_worker_pkg/`)
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —á–∞–Ω–∫–∏ –±–µ–∑ `vector_id`
   - –ü–æ–ª—É—á–∞–µ—Ç embeddings —á–µ—Ä–µ–∑ `SVOClientManager.get_embeddings()`
   - –î–æ–±–∞–≤–ª—è–µ—Ç –≤–µ–∫—Ç–æ—Ä—ã –≤ FAISS –∏–Ω–¥–µ–∫—Å
   - –û–±–Ω–æ–≤–ª—è–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

3. **SemanticSearch** (`code_analysis/commands/semantic_search_mcp.py`)
   - ‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π embedding —Å–µ—Ä–≤–∏—Å –¥–ª—è –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
   - ‚úÖ **Fallback**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Å–µ–≤–¥–æ-—ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞

### –ü—Ä–æ—Ü–µ—Å—Å –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

1. **–ß–∞–Ω–∫–∏–Ω–≥** (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):
   - –§–∞–π–ª—ã —Ä–∞–∑–±–∏–≤–∞—é—Ç—Å—è –Ω–∞ —á–∞–Ω–∫–∏ —á–µ—Ä–µ–∑ chunker —Å–µ—Ä–≤–∏—Å
   - –ß–∞–Ω–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î —Å `vector_id = NULL`

2. **–í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**:
   - –í–æ—Ä–∫–µ—Ä –Ω–∞—Ö–æ–¥–∏—Ç —á–∞–Ω–∫–∏ –±–µ–∑ `vector_id`
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∞–Ω–∫–∞:
     - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ `embedding_vector` –≤ –ë–î
     - –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —á–µ—Ä–µ–∑ `SVOClientManager.get_embeddings()`
     - –ü–æ–ª—É—á–∞–µ—Ç embedding –æ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ (–∏–ª–∏ –ø—Å–µ–≤–¥–æ-—ç–º–±–µ–¥–¥–∏–Ω–≥ –∫–∞–∫ fallback)
     - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç embedding –≤ –ë–î (`embedding_vector`)
     - –î–æ–±–∞–≤–ª—è–µ—Ç –≤–µ–∫—Ç–æ—Ä –≤ FAISS –∏–Ω–¥–µ–∫—Å
     - –ü–æ–ª—É—á–∞–µ—Ç `vector_id` –æ—Ç FAISS
     - –û–±–Ω–æ–≤–ª—è–µ—Ç —á–∞–Ω–∫ –≤ –ë–î —Å `vector_id`

3. **–ü–æ–∏—Å–∫**:
   - –ó–∞–ø—Ä–æ—Å –≤–µ–∫—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `SVOClientManager.get_embeddings()`
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–π embedding —Å–µ—Ä–≤–∏—Å (–∏–ª–∏ –ø—Å–µ–≤–¥–æ-—ç–º–±–µ–¥–¥–∏–Ω–≥ –∫–∞–∫ fallback)
   - –ü–æ–∏—Å–∫ –≤ FAISS –∏–Ω–¥–µ–∫—Å–µ –ø–æ –≤–µ–∫—Ç–æ—Ä—É –∑–∞–ø—Ä–æ—Å–∞
   - –í–æ–∑–≤—Ä–∞—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ embedding

```json
{
  "code_analysis": {
    "embedding": {
      "enabled": true,
      "url": "localhost",
      "port": 8001,
      "protocol": "mtls",
      "cert_file": "mtls_certificates/.../client/code-analysis.crt",
      "key_file": "mtls_certificates/.../client/code-analysis.key",
      "ca_cert_file": "mtls_certificates/.../ca/ca.crt",
      "crl_file": null,
      "timeout": 60.0,
      "retry_attempts": 3,
      "retry_delay": 5.0
    }
  }
}
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

- **enabled**: –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å embedding —Å–µ—Ä–≤–∏—Å
- **url** / **host**: URL –∏–ª–∏ hostname —Å–µ—Ä–≤–∏—Å–∞
- **port**: –ü–æ—Ä—Ç —Å–µ—Ä–≤–∏—Å–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 8001)
- **protocol**: –ü—Ä–æ—Ç–æ–∫–æ–ª —Å–≤—è–∑–∏ (`http`, `https`, `mtls`)
- **cert_file**: –ü—É—Ç—å –∫ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º—É —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—É (–¥–ª—è mTLS)
- **key_file**: –ü—É—Ç—å –∫ –ø—Ä–∏–≤–∞—Ç–Ω–æ–º—É –∫–ª—é—á—É (–¥–ª—è mTLS)
- **ca_cert_file**: –ü—É—Ç—å –∫ CA —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—É (–¥–ª—è mTLS/HTTPS)
- **crl_file**: –ü—É—Ç—å –∫ CRL —Ñ–∞–π–ª—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è mTLS)
- **timeout**: –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
- **retry_attempts**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–≤—Ç–æ—Ä–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ
- **retry_delay**: –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö

## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### SVOClientManager

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã**:
- `initialize()`: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π `EmbeddingServiceAsyncClient` –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `get_embeddings()`: –ü–æ–ª—É—á–∞–µ—Ç embeddings —á–µ—Ä–µ–∑ —Ä–µ–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –∏–ª–∏ fallback –Ω–∞ –ø—Å–µ–≤–¥–æ-—ç–º–±–µ–¥–¥–∏–Ω–≥–∏
- `close()`: –ó–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —Å–µ—Ä–≤–∏—Å–æ–º

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã**:
1. –ï—Å–ª–∏ `embedding.enabled = true` –∏ `embed_client` –¥–æ—Å—Ç—É–ø–µ–Ω:
   - –°–æ–∑–¥–∞–µ—Ç `EmbeddingServiceAsyncClient` —á–µ—Ä–µ–∑ `ClientFactory`
   - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è embeddings
2. –ò–Ω–∞—á–µ:
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Å–µ–≤–¥–æ-—ç–º–±–µ–¥–¥–∏–Ω–≥–∏ (–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã –∏–∑ —Ö–µ—à–∞ —Ç–µ–∫—Å—Ç–∞)

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Ç–µ–π –∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º

- –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏ —Ä–∞–∑—Ä–µ—à–∞—é—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞
- –ö–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∏–∑ `db_path` –∏–ª–∏ `log` –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ê–±—Å–æ–ª—é—Ç–Ω—ã–µ –ø—É—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–∞–Ω–∫–æ–≤**: 100% –∑–∞–≤–µ—Ä—à–µ–Ω–∞
2. **–†–µ–∞–ª—å–Ω—ã–π embedding —Å–µ—Ä–≤–∏—Å**: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ `SVOClientManager`
3. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: –ü—Ä–∞–≤–∏–ª—å–Ω–æ —á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ `config.json`
4. **Fallback**: –ü—Å–µ–≤–¥–æ-—ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞
5. **Semantic search**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π embedding —Å–µ—Ä–≤–∏—Å –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤

### ‚ö†Ô∏è –ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

1. **–†–∞–±–æ—Ç–∞ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ embedding —Å–µ—Ä–≤–∏—Å –¥–æ—Å—Ç—É–ø–µ–Ω –∏ –æ—Ç–≤–µ—á–∞–µ—Ç
2. **–ö–∞—á–µ—Å—Ç–≤–æ –ø–æ–∏—Å–∫–∞**: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å semantic search —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ embeddings
3. **–í–æ—Ä–∫–µ—Ä**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤–æ—Ä–∫–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ **–ó–∞–≤–µ—Ä—à–µ–Ω–æ**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ embedding —Å–µ—Ä–≤–∏—Å–∞
2. ‚úÖ **–ó–∞–≤–µ—Ä—à–µ–Ω–æ**: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ semantic search –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
3. ‚è≥ **–¢—Ä–µ–±—É–µ—Ç—Å—è**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –ø–æ–∏—Å–∫–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ embeddings
4. ‚è≥ **–¢—Ä–µ–±—É–µ—Ç—Å—è**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–±–æ—Ç—ã embedding —Å–µ—Ä–≤–∏—Å–∞

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≤–µ—Ä—à–µ–Ω–∞** (100% —á–∞–Ω–∫–æ–≤ –≤–µ–∫—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã).

**–†–µ–∞–ª—å–Ω—ã–π embedding —Å–µ—Ä–≤–∏—Å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω** –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:
- –í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–æ–≤—ã—Ö —á–∞–Ω–∫–æ–≤ (—á–µ—Ä–µ–∑ –≤–æ—Ä–∫–µ—Ä)
- –í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (—á–µ—Ä–µ–∑ semantic_search)

**Fallback –Ω–∞ –ø—Å–µ–≤–¥–æ-—ç–º–±–µ–¥–¥–∏–Ω–≥–∏** —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã.

